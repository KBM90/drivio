# Code Vulnerability Review Checklist

## 1. Authentication & Authorization

### Authentication Issues
- [ ] **Weak Password Policies**: Check for minimum length, complexity requirements
- [ ] **Hardcoded Credentials**: Search for API keys, passwords, tokens in code
- [ ] **Insecure Session Management**: Verify session tokens are secure, random, and expire
- [ ] **Missing Multi-Factor Authentication**: Check if MFA is implemented for sensitive operations
- [ ] **Broken Authentication**: Test login bypass vulnerabilities

### Authorization Issues
- [ ] **Insufficient Access Controls**: Verify users can only access their own resources
- [ ] **Privilege Escalation**: Test if users can elevate permissions
- [ ] **Missing Authorization Checks**: Ensure all endpoints verify user permissions
- [ ] **Insecure Direct Object References (IDOR)**: Check if IDs can be manipulated to access others' data
- [ ] **JWT Vulnerabilities**: Verify JWT signature validation, expiration, and secure storage

## 2. Input Validation & Sanitization

### Injection Attacks
- [ ] **SQL Injection**: Check for parameterized queries, ORM usage
- [ ] **NoSQL Injection**: Verify MongoDB/Firebase queries are sanitized
- [ ] **Command Injection**: Check system command execution with user input
- [ ] **LDAP Injection**: Verify LDAP query sanitization
- [ ] **XML Injection**: Check XML parser configurations

### Cross-Site Scripting (XSS)
- [ ] **Reflected XSS**: Test user input reflection without sanitization
- [ ] **Stored XSS**: Check database-stored content rendering
- [ ] **DOM-Based XSS**: Review client-side JavaScript manipulation
- [ ] **Content Security Policy**: Verify CSP headers are configured

### Other Input Issues
- [ ] **Path Traversal**: Test file path manipulation (../, absolute paths)
- [ ] **File Upload Vulnerabilities**: Verify file type validation, size limits, malware scanning
- [ ] **XML External Entity (XXE)**: Check XML parser configurations
- [ ] **Server-Side Request Forgery (SSRF)**: Test URL parameter manipulation

## 3. Data Protection

### Sensitive Data Exposure
- [ ] **Unencrypted Data in Transit**: Verify HTTPS/TLS usage
- [ ] **Unencrypted Data at Rest**: Check database encryption, file encryption
- [ ] **Weak Cryptography**: Verify use of strong algorithms (AES-256, RSA-2048+)
- [ ] **Exposed Secrets in Logs**: Check logs don't contain passwords, tokens, PII
- [ ] **Sensitive Data in URLs**: Verify tokens/passwords aren't in query parameters

### Personal Information
- [ ] **PII Handling**: Verify GDPR/CCPA compliance for personal data
- [ ] **Data Retention Policies**: Check if data is deleted when no longer needed
- [ ] **Backup Security**: Verify backups are encrypted and access-controlled
- [ ] **Data Masking**: Check if sensitive data is masked in non-production environments

## 4. API Security

### API Vulnerabilities
- [ ] **Missing Rate Limiting**: Check for DoS protection, brute force prevention
- [ ] **Mass Assignment**: Verify object properties are whitelisted
- [ ] **Broken Object Level Authorization**: Test accessing others' resources via API
- [ ] **Excessive Data Exposure**: Check if APIs return unnecessary sensitive data
- [ ] **Lack of Resources & Rate Limiting**: Verify pagination, result limits

### API Configuration
- [ ] **CORS Misconfiguration**: Check Access-Control-Allow-Origin settings
- [ ] **Missing API Versioning**: Verify version management strategy
- [ ] **Insecure HTTP Methods**: Check if DELETE, PUT are properly restricted
- [ ] **API Key Exposure**: Verify API keys aren't in client-side code

## 5. Business Logic Flaws

- [ ] **Race Conditions**: Test concurrent request handling
- [ ] **Insufficient Anti-Automation**: Check for CAPTCHA on sensitive operations
- [ ] **Price Manipulation**: Verify price/quantity calculations server-side
- [ ] **Workflow Bypasses**: Test if steps in multi-step processes can be skipped
- [ ] **Time-of-Check to Time-of-Use (TOCTOU)**: Check for race condition vulnerabilities

## 6. Client-Side Security

### Mobile/Flutter Specific
- [ ] **Insecure Data Storage**: Check SharedPreferences, local storage for sensitive data
- [ ] **Certificate Pinning**: Verify SSL/TLS certificate validation
- [ ] **Code Obfuscation**: Check if production builds are obfuscated
- [ ] **Root/Jailbreak Detection**: Verify app detects compromised devices
- [ ] **Reverse Engineering Protection**: Check for anti-tampering measures

### Web/JavaScript
- [ ] **localStorage/sessionStorage**: Verify no sensitive data in browser storage
- [ ] **Exposed Source Maps**: Check production doesn't serve .map files
- [ ] **Client-Side Validation Only**: Ensure server-side validation exists
- [ ] **Insecure Dependencies**: Run `npm audit`, check for known vulnerabilities

## 7. Third-Party Dependencies

- [ ] **Outdated Dependencies**: Check for latest security patches
- [ ] **Known Vulnerabilities**: Use tools like Snyk, Dependabot, OWASP Dependency-Check
- [ ] **Unnecessary Permissions**: Verify third-party SDKs don't request excessive permissions
- [ ] **Supply Chain Attacks**: Verify package integrity, use lock files
- [ ] **Abandoned Packages**: Check if dependencies are actively maintained

## 8. Infrastructure & Configuration

### Server Configuration
- [ ] **Default Credentials**: Verify no default passwords on databases, admin panels
- [ ] **Exposed Admin Interfaces**: Check admin panels aren't publicly accessible
- [ ] **Directory Listing**: Verify web server doesn't list directories
- [ ] **Error Messages**: Check error messages don't expose stack traces, versions
- [ ] **Security Headers**: Verify X-Frame-Options, X-Content-Type-Options, etc.

### Cloud Security (Supabase/Firebase)
- [ ] **Row Level Security (RLS)**: Verify Supabase RLS policies are implemented
- [ ] **Database Permissions**: Check database roles have least privilege
- [ ] **Public Buckets**: Verify storage buckets have proper access controls
- [ ] **API Key Exposure**: Check if anon keys are used appropriately
- [ ] **Backup & Recovery**: Verify automated backups are configured

## 9. Logging & Monitoring

- [ ] **Insufficient Logging**: Verify security events are logged
- [ ] **Sensitive Data in Logs**: Check logs don't contain passwords, tokens
- [ ] **Missing Alert Mechanisms**: Verify alerts for suspicious activities
- [ ] **Log Injection**: Check if user input in logs is sanitized
- [ ] **Audit Trails**: Verify critical actions are auditable

## 10. Mobile-Specific (Flutter/Dart)

### Flutter Security
- [ ] **Insecure HTTP Connections**: Verify all connections use HTTPS
- [ ] **Deep Link Vulnerabilities**: Check deep link parameter validation
- [ ] **WebView Security**: Verify JavaScript is disabled unless necessary
- [ ] **Biometric Authentication**: Check secure enclave usage for sensitive data
- [ ] **Platform Channels**: Verify native code interactions are secure

### Permissions
- [ ] **Excessive Permissions**: Check AndroidManifest.xml / Info.plist
- [ ] **Runtime Permission Checks**: Verify permissions are requested properly
- [ ] **Permission Rationale**: Check users are informed why permissions are needed

## 11. Testing Recommendations

### Security Testing
- [ ] **Static Application Security Testing (SAST)**: Run automated code analysis
- [ ] **Dynamic Application Security Testing (DAST)**: Test running application
- [ ] **Penetration Testing**: Conduct manual security testing
- [ ] **Dependency Scanning**: Check for vulnerable dependencies
- [ ] **Secret Scanning**: Scan for exposed credentials in code/commits

### Tools to Use
- **Dart/Flutter**: `dart analyze`, Flutter secure storage audit
- **Dependencies**: `flutter pub outdated`, Snyk, Dependabot
- **Secrets**: GitGuardian, TruffleHog, git-secrets
- **API Testing**: Postman, Burp Suite, OWASP ZAP
- **General**: SonarQube, Checkmarx, Veracode

## 12. Compliance & Standards

- [ ] **OWASP Top 10**: Verify protection against all OWASP Top 10 vulnerabilities
- [ ] **GDPR Compliance**: Check data privacy requirements (EU)
- [ ] **CCPA Compliance**: Check data privacy requirements (California)
- [ ] **PCI DSS**: If handling payments, verify PCI compliance
- [ ] **HIPAA**: If handling health data, verify HIPAA compliance
- [ ] **SOC 2**: Check security controls alignment

## Priority Levels

### ðŸ”´ Critical (Fix Immediately)
- SQL Injection, Authentication bypass, RCE, Exposed credentials, Data breaches

### ðŸŸ  High (Fix Within Days)
- XSS, CSRF, IDOR, Missing authorization, Weak encryption

### ðŸŸ¡ Medium (Fix Within Weeks)
- Information disclosure, Missing rate limiting, Weak password policy

### ðŸŸ¢ Low (Fix When Possible)
- Missing security headers, Verbose error messages, Code quality issues

---

## Usage Instructions

1. **Review Each Category**: Go through each section systematically
2. **Mark Items**: Check off items as you verify them
3. **Document Findings**: Note any vulnerabilities discovered
4. **Prioritize Fixes**: Use priority levels to determine fix order
5. **Retest**: After fixes, verify vulnerabilities are resolved
6. **Continuous Monitoring**: Repeat this checklist for each major release

## Additional Resources

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [CWE Top 25](https://cwe.mitre.org/top25/)
- [Flutter Security Best Practices](https://docs.flutter.dev/security)
- [Supabase Security Guide](https://supabase.com/docs/guides/auth)